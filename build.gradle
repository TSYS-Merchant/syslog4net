version = '2.0.1-SNAPSHOT'

// You can't have non-digits in a DLL version number
project.ext.set("baseVersion", project.version.minus('-SNAPSHOT'))

task clean(type: Exec) {
    workingDir 'src/main/dot-net'
    commandLine 'cmd', '/c', 'dotnet.exe', 'clean', 'syslog4net.sln'
}

task restore(type: Exec) {
    workingDir 'src/main/dot-net'
    commandLine 'cmd', '/c', 'dotnet.exe', 'restore', 'syslog4net.sln'
}

task build(type: Exec) {
    workingDir 'src/main/dot-net'
    commandLine 'cmd', '/c', 'dotnet.exe', 'build', 'syslog4net.sln'
}

task test(type: Exec) {
    workingDir 'src/main/dot-net'
    commandLine 'cmd', '/c', 'dotnet.exe', 'test', 'syslog4net.sln'
}

task packageNuget(type: Exec) {
    workingDir 'src/main/dot-net/syslog4net'
    commandLine 'cmd', '/c', 'dotnet.exe', 'pack', 'syslog4net.csproj', '--configuration', 'Release', '--output', workingDir , '-p:PackageVersion=' + project.baseVersion
}

restore.dependsOn clean
build.dependsOn restore
test.dependsOn build
packageNuget.dependsOn test